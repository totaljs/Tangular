(function(e){if(e.Tangular)return;var t={};var v=t.helpers={};t.version='v5.0.1';t.cache={};e.Ta=e.Tangular=t;e.Thelpers=v;var s={null:true,undefined:true,true:true,false:true,Object:1,String:1,Number:1,Boolean:1,Date:1,Array:1,window:1,global:1,arguments:1,eval:1,Function:1,function:1,var:1,let:1,const:1,delete:1};var i=/\{\{.*?\}\}/g;var y=/\{\{|\}\}/g;var r=/[<>&"]/g;var n=/\n$/g;function k(e,r){var t='';var i=[];var n=0;for(var a=0;a<e.length;a++){var l=e.charCodeAt(a);if(!n){if(t&&l>47&&l<58||l>64&&l<91||l>96&&l<123||(l===95||l===36)){t+=e.charAt(a);continue}if(t){if(!s[t]&&i.indexOf(t)===-1&&(!r||r.indexOf(t)===-1))i.push(t);t=''}}if(l===46||l===124){n=l}else if((n===46||n===124)&&l===40){n=0}else if(l===96||l===34||l===39){if(l===n)n=0;else n=l}}if(t&&!s[t]&&i.indexOf(t)===-1&&(!r||r.indexOf(t)===-1))i.push(t);return i}t.toArray=function(e){var r=Object.keys(e);var t=[];for(var i=0,n=r.length;i<n;i++)t.push({key:r[i],value:e[r[i]]});return t};function a(){this.commands;this.variables;this.builder;this.split='\0'}a.prototype.compile=function(e){var g=this;var m=0;var b=0;var $;var x=[];g.template=e;e=e.replace(/\|\|/g,'');g.variables={};g.commands=[];g.builder=e.replace(i,function(f){var e=f.replace(y,'').trim();var r=null;var t=null;var i;var c=false;var v=false;var p=true;if(e==='fi'){m--}else if(e==='end'){b--;x.pop()}else if(e.substring(0,3)==='if '){m++;r=k(e.substring(3),x);if(r.length){for(var n=0;n<r.length;n++){var a=r[n];if(g.variables[a])g.variables[a]++;else g.variables[a]=1}}else r=null;c=true;p=true}else if(e.substring(0,8)==='foreach '){b++;$=e.substring(8).split(' ');x.push($[0].trim());i=$[2].indexOf('.');if(i!==-1)$[2]=$[2].substring(0,i);r=$[2].trim();if(x.indexOf(r)===-1){if(g.variables[r])g.variables[r]++;else g.variables[r]=1;r=[r]}else r=null;v=true}else if(e.substring(0,8)==='else if '){r=k(e.substring(8),x);if(r.length){for(var n=0;n<r.length;n++){var a=r[n];if(g.variables[a])g.variables[a]++;else g.variables[a]=1}}else r=null;c=true}else if(e!=='continue'&&e!=='break'&&e!=='else'){r=k(e);var l=false;for(var n=0;n<r.length;n++){var s=r[n];if(s+'('===e.substring(0,s.length+1)){l=true;continue}if(g.variables[s])g.variables[s]++;else g.variables[s]=1}if(!r.length)r=null;var u=e.indexOf('|');var h=null;if(l){h=e.substring(0,u===-1?e.length:u);if(u===-1)e='';else e=''+e.substring(i)}else if(!l&&u===-1)e+=' | encode';t=e.split('|');e=t[0];t=t.slice(1);if(l)t.unshift(h);if(t.length){for(var n=0;n<t.length;n++){var o=t[n].trim();var d=l&&!n;i=o.indexOf('(');if(i===-1){o='Thelpers.$execute($helpers,model,\''+o+'\','+(d?'':')')}else o='Thelpers.$execute($helpers,model,\''+o.substring(0,i)+'\','+(d?'':',')+o.substring(i+1);t[n]=o}}else t=null;e=g.safe(e.trim()||'model');p=false}g.commands.push({index:g.commands.length,cmd:e,ifcount:m,loopcount:b,variable:r,helpers:t,isloop:v,isif:c,iscode:p});return g.split}).split(g.split);for(var r=0;r<g.builder.length;r++){var t=g.builder[r];g.builder[r]=t?t.replace(n,''):t}return g.make()};a.prototype.safe=function(e){var r=e.split('.');var t=[];for(var i=1;i<r.length;i++){var n=r.slice(0,i).join('.');t.push(n+'==null?\'\':')}return t.join('')+r.join('.')};a.prototype.make=function(){var e=this;var r=['var $output=$text[0];var $tmp;var $index=0;'];for(var t=0,f=e.commands.length;t<f;t++){var i=e.commands[t];var n;t&&r.push('$output+=$text['+t+'];');if(i.iscode){if(i.isloop){var a='$i'+Math.random().toString(16).substring(3,6);var l=a+'a';n=i.cmd.substring(i.cmd.lastIndexOf(' in ')+4).trim();n=l+'='+e.safe(n)+';if(!('+l+' instanceof Array)){if('+l+'&&typeof('+l+')===\'object\')'+l+'=Tangular.toArray('+l+')}if('+l+' instanceof Array&&'+l+'.length){for(var '+a+'=0,'+a+'l='+l+'.length;'+a+'<'+a+'l;'+a+'++){$index='+a+';var '+i.cmd.split(' ')[1]+'='+l+'['+a+'];';r.push(n)}else if(i.isif){if(i.cmd.substring(0,8)==='else if ')r.push('}'+i.cmd.substring(0,8).trim()+'('+i.cmd.substring(8).trim()+'){');else r.push(i.cmd.substring(0,3).trim()+'('+i.cmd.substring(3).trim()+'){')}else{switch(i.cmd){case'else':r.push('}else{');break;case'end':r.push('}}');break;case'fi':r.push('}');break;case'break':r.push('break;');break;case'continue':r.push('continue;');break}}}else{if(i.helpers){var s='';for(var u=0;u<i.helpers.length;u++){var c=i.helpers[u];if(u===0)s=c.replace('',i.cmd.trim()).trim();else s=c.replace('',s.trim())}r.push('$tmp='+s+';if($tmp!=null)$output+=$tmp;')}else r.push('if('+i.cmd+'!=null)$output+='+i.cmd+';')}}r.push((f?'$output+=$text['+f+'];':'')+'return $output.charAt(0) === \'\\n\'?$output.substring(1):$output;');delete e.variables.$;var o=Object.keys(e.variables);var v=['$helpers||{}','$||{}','model'];for(var t=0;t<o.length;t++)v.push('model.'+o[t]);for(var t=0;t<e.builder.length;t++)e.builder[t]=e.builder[t].replace(/\1/g,'||');var p='var tangular=function($helpers,$,model'+(o.length?','+o.join(','):'')+'){'+r.join('')+'};return function(model,$,$helpers){try{return tangular('+v.join(',')+')}catch(e){console.error(\'Tangular error:\',e + \'\',$template)}}';return new Function('$text','$template',p.replace(/\1/g,'||'))(e.builder,e.template)};v.$execute=function(e,r,t,i,n,a,l,s,u,f,c){var o=v[t]||e[t];if(!o){console&&console.warn('Tangular: missing helper','"'+t+'"');return i}return o.call(r,i,n,a,l,s,u,f,c)};v.encode=function(e){return e==null?'':(e+'').replace(r,function(e){switch(e){case'&':return'&amp;';case'<':return'&lt;';case'>':return'&gt;';case'"':return'&quot;'}return e})};v.raw=function(e){return e};t.render=function(e,r,t,i){var e=(new a).compile(e);return e(r==null?{}:r,t,i)};t.compile=function(e){return(new a).compile(e)};t.register=function(e,r){v[e]=r;return t}})(typeof window==='undefined'?global:window);